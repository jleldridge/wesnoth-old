#textdomain wesnoth

[test]
    id=total_defense
    name=_"Total Defense"
    next_scenario=micro_ai_test

    map_data="{multiplayer/maps/2p_The_Freelands.map}"

    {DEFAULT_SCHEDULE}
    turns=-1
    victory_when_enemies_defeated=yes

    [side]
        side=1
        controller=ai
        id=Rebels1
        type=Elvish Ranger

        team_name=Rebels1
        user_team_name=_"Rebels 1"
        recruit=Elvish Archer,Elvish Fighter,Elvish Scout,Elvish Shaman,Mage,Merman Hunter,Wose
        persistent=no

        gold=400

        {MICRO_AI_TOTAL_DEFENSE}
    [/side]

    [side]
        side=2
        controller=ai
        id=Rebels2
        type=Elvish Marksman

        team_name=Rebels2
        user_team_name=_"Rebels 2"
        recruit=Elvish Archer,Elvish Fighter,Elvish Scout,Elvish Shaman,Mage,Merman Hunter,Wose
        persistent=no

        gold=400

        {MICRO_AI_HEALER_SUPPORT}
    [/side]

    [side]  # This side is only here because we need one persistent side for the game to go on
        side=3
        controller=null
        persistent=yes
        save_id=Grnk
        hidden=yes
    [/side]

    # Prestart actions
    [event]
        name=prestart

        {VARIABLE scenario_name total_defense}

        # Set up the healer support micro AIs
        [micro_ai]
            side=1
            ai_type=total_defense
            action=add
            defend_x=18
            defend_y=9
            radius=2
        [/micro_ai]

        [micro_ai]
            side=2
            ai_type=healer_support
            action=add

            aggression=0 # wmllint: ignore
        [/micro_ai]
    [/event]

    [event]
        name=turn 4
        {MODIFY_AI_DELETE_CANDIDATE_ACTION 1 main_loop recruitment}
    [/event]

    # Stop if the leader of one side died
    [event]
        name=die
        first_time_only=no
        [filter]
            canrecruit=yes
        [/filter]

        {MESSAGE $unit.id "" "" _"Argh!  They got us..."}

        # So that game goes on to next scenario
        [modify_side]
            side=3
            controller=human
        [/modify_side]

        [endlevel]
            result=victory
            bonus=no
            carryover_percentage=0
            carryover_report=no
            linger_mode=no
        [/endlevel]
    [/event]
[/test]
